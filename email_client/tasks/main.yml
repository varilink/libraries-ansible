- name: Install email client role
  become: yes
  block:

    - name: Install apt package(s) for email client role
      apt:
        name: exim4-daemon-light

    - name: Template update-exim4.conf.conf file
      template:
        src: update-exim4.conf.conf.j2
        dest: /etc/exim4/update-exim4.conf.conf

    - name: Template passwd.client file
      template:
        src: passwd.client.j2
        dest: /etc/exim4/passwd.client
        group: Debian-exim
        mode: '0640'

    - name: Run update-exim4.conf
      command: update-exim4.conf

    - name: Redirect emails to root to myself
      lineinfile:
        path: /etc/aliases
        # TODO: Parameterise
        # This email address is public knowledge however it should be
        # parameterised.
        line: 'root: david.williamson@varilink.co.uk'
